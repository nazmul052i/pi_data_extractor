<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Iq_builder.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="IQconfig|Working with IQ Modules">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Creating or Editing a Calculation</title>
        <link href="../flare_styles.css" rel="StyleSheet" type="text/css" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <h1><a name="kanchor210"></a>Creating or Editing a Calculation</h1>
        <p>This section describes how to create or edit a Calculation 
 (input or output) in Aspen IQ. A Calculation consists of a <a href="input_calculation_ic_module.htm#Formula_aspeniq">Formula</a> 
 and a specification of <a href="input_calculation_ic_module.htm#Parameters_aspeniq">Parameters</a>.</p>
        <table class="notebox">
            <col />
            <tbody>
                <tr>
                    <td>
                        <p><span style="font-weight: bold;">Note:</span> &#160;The 
 sections on the Calculation modules focus largely on the IC module because 
 the only difference between the IC and OC modules is the timing of their 
 execution. Also, because Aspen IQ is using the Aspen Calc Calculation 
 and Formula functionalities, see the <span style="font-style: italic;">Aspen 
 Calc Help</span> for detailed instructions on creating and editing a Calculation. For more information, see the following topics:</p>
                        <ul>
                            <li><a href="input_calculation_ic_module.htm">Input 
 Calculation (IC) and Output Calculation (OC) Modules</a>
                            </li>
                            <li><a href="working_with_formulas.htm">Creating 
 or Editing a Formula</a>
                            </li>
                            <li><a href="mapping_calculation_variables.htm">Mapping 
 Calculation Variables</a>
                            </li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>To create an input or output calculation:</p>
        <ol>
            <li value="1">
                <p>Right-click 
		 an IQ in the tree and select <span style="font-weight: bold;">Properties</span>. 
		 The <span style="font-weight: bold;">Inferential Quality Properties</span> 
		 dialog box is displayed. This dialog box allows you to select 
		 the various modules.</p>
                <p>
                    <img alt="image\iqp.gif" border="0" src="../image/iqp.gif" title="image\iqp.gif" />
                </p>
            </li>
            <li value="2">
                <p>Select 
		 the <span style="font-weight: bold;">Input Calculations</span> 
		 option.</p>
                <table class="notebox">
                    <col />
                    <tbody>
                        <tr>
                            <td>
                                <p><span style="font-weight: bold;">Note:</span> 
		 &#160;If you are creating an output calculation, select the <span style="font-weight: bold;">Output Calculations</span> option.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="3">
                <p>Click 
		 <span style="font-weight: bold;">OK</span>. An IC (Input Calculations) 
		 folder is created beneath the IQ folder. This folder will contain 
		 two sub folders: INVAR and OUTVAR.</p>
                <p>
                    <img alt="image\iqcalcic2.gif" border="0" height="127" src="../image/iqcalcic2.gif" title="image\iqcalcic2.gif" width="705" />
                </p>
            </li>
            <li value="4">
                <p>Right 
		 click the <span style="font-weight: bold;">IC</span> (Input Calculations) 
		 folder and select <span style="font-weight: bold;">Properties</span>. 
		 The <span style="font-weight: bold;">Calculation</span> <span style="font-weight: bold;">Properties</span> dialog box is displayed.</p>
                <p>
                    <img alt="image\calprop.gif" border="0" height="386" src="../image/calprop.gif" title="image\calprop.gif" width="640" />
                </p>
            </li>
            <li value="5">
                <p>Click 
		 <span style="font-weight: bold;">Edit Calculation</span> to display 
		 the Aspen Calc Calculation Wizard. By default, this action will 
		 create a blank calculation based on a CalcScript formula. If you 
		 want to use a different type of formula (for example, VBScript), 
		 click the <span style="font-weight: bold;">Back</span> button 
		 to select the type.</p>
                <table class="notebox">
                    <col />
                    <tbody>
                        <tr>
                            <td>
                                <p><span style="font-weight: bold;">Note:</span> 
		 &#160;If Aspen IQ cannot connect to the Aspen Calc engine, then 
		 an error box is displayed. Start the Aspen Calc service and try 
		 and connect to Aspen Calc again. Each time you click <span style="font-weight: bold;">Edit 
		 Calculation</span>, Aspen IQ will try to connect to the Aspen 
		 Calc engine.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>
                    <img alt="image\calcwiz.gif" border="0" height="367" src="../image/calcwiz.gif" title="image\calcwiz.gif" width="489" />
                </p>
            </li>
            <li value="6">
                <p>You 
		 can use the Aspen Calc Calculation Wizard in several ways:</p>
                <ol style="list-style-type: lower-alpha;">
                    <li value="1">
                        <p style="margin-top: 0.8em;">If 
				 you choose to create a calculation based on a new formula 
				 of type CalcScript, then the Aspen Calc Function Wizard 
				 will automatically figure out which variables are inputs 
				 and which are outputs.</p>
                        <table class="notebox">
                            <col />
                            <tbody>
                                <tr>
                                    <td>
                                        <p><span style="font-weight: bold;">Note:</span> 
				 &#160;Loops and arrays are not available in CalcScript 
				 but are available in VBScript.</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                    <li value="2">
                        <p>If 
				 you choose to create a calculation based on a new formula 
				 of type VBScript, you are responsible for designating 
				 variables as inputs or outputs individually. However, 
				 VBScript is much more powerful than Calc Script.</p>
                        <table class="notebox">
                            <col />
                            <tbody>
                                <tr>
                                    <td>
                                        <p><span style="font-weight: bold;">Note:</span> 
				 &#160;For more information on CalcScript , VBScript and 
				 the Aspen Calc Calculation Wizard, see the <span style="font-style: italic;">Aspen 
				 Calc Help</span>.</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                    <li value="3">
                        <p>If 
				 you choose to create a calculation based on an existing 
				 formula, then the calculation will automatically figure 
				 out the inputs and outputs based on the properties of 
				 the formula.</p>
                        <table class="notebox">
                            <col />
                            <tbody>
                                <tr>
                                    <td>
                                        <p><span style="font-weight: bold;">Note:</span> 
				 &#160;Only the built-in library and application specific 
				 library (IQconfigAppName) are supported.</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                </ol>
            </li>
            <li value="7">
                <p>Type 
		 a formula or click <span style="font-weight: bold;">InsertFormula</span> to use an existing 
		 formula. The <span style="font-weight: bold;">Insert Formula</span> 
		 dialog box is displayed if you selected the second option.</p>
                <table class="notebox">
                    <col />
                    <tbody>
                        <tr>
                            <td>
                                <p><span style="font-weight: bold;">Important:</span> 
		 &#160;Formulas used in conjunction with Aspen IQ must come from 
		 the built-in library or the library named specifically after the 
		 iqf that you are editing (for example, IQconfigAppName).</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>
                    <img alt="image\insertf.gif" border="0" height="300" src="../image/insertf.gif" title="image\insertf.gif" width="462" />
                </p>
            </li>
            <li value="8">
                <p>Select 
		 a formula and click <span style="font-weight: bold;">Insert</span>. 
		 You will return to the Calculation Wizard.</p>
            </li>
            <li value="9">
                <p>Click 
		 <span style="font-weight: bold;">Next</span>.</p>
            </li>
            <li value="10">
                <p>Define 
		 the inputs and outputs of the calculation. Click <span style="font-weight: bold;">Next</span>.</p>
            </li>
            <li value="11">
                <p>Click 
		 <span style="font-weight: bold;">Finish</span>.</p>
            </li>
            <li value="12">
                <p>Upon 
		 completing the Wizard, IQconfig will fill out the inputs and outputs 
		 in the <span style="font-weight: bold;">Input Variables</span> 
		 and <span style="font-weight: bold;">Output Variables</span> list, 
		 respectively.</p>
                <table class="notebox">
                    <col />
                    <tbody>
                        <tr>
                            <td>
                                <p><span style="font-weight: bold;">Note:</span> 
		 &#160;Aspen Calc provides a persistent output variable called 
		 <span style="font-weight: bold;">ReturnValue</span>. You may use 
		 this variable as an output in your calculation or you may choose 
		 to ignore it and use variables with more meaningful names. In 
		 either case, <span style="font-weight: bold;">ReturnValue</span> 
		 will appear in the list of outputs.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p>
                    <img alt="image\calcpropfull2.gif" border="0" height="386" src="../image/calcpropfull2.gif" title="image\calcpropfull2.gif" width="640" />
                </p>
            </li>
            <li value="13">
                <p>At 
		 this point, you can configure each of the inputs and outputs. 
		 Choices for configuration include:</p>
                <ul>
                    <li>
                        <p>In the <span style="font-weight: bold;">Keyword</span> column, enter <span style="font-weight: bold;">LOCAL</span> and in the <span style="font-weight: bold;">Value</span> 
			 column, enter a value.</p>
                    </li>
                    <li>
                        <p>In the <span style="font-weight: bold;">Keyword</span> column, enter <span style="font-weight: bold;">READ</span> and set up the Cim-IO 
			 information.</p>
                    </li>
                    <li>
                        <p>In the <span style="font-weight: bold;">Map</span> <span style="font-weight: bold;">From</span> 
			 (<span style="font-weight: bold;">Map To</span> for outputs) 
			 column, map the variable to another IQ variable.</p>
                    </li>
                </ul>
                <table class="notebox">
                    <col />
                    <tbody>
                        <tr>
                            <td>
                                <p><span style="font-weight: bold;">Note:</span> 
		 &#160;For more information on mapping variables, see <a href="mapping_calculation_variables.htm">Mapping 
		 Calculation Variables</a>.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li value="14">
                <p>After 
		 configuring all inputs and outputs, click <span style="font-weight: bold;">OK</span> 
		 and exit the dialog box.</p>
            </li>
            <li value="15">
                <p>Complete 
		 configuring other parts of the <span style="font-weight: bold;">.iqf</span> 
		 (optional) and then <a href="saving_an_iqf.htm">save the iqf</a>.</p>
            </li>
            <li value="16">
                <p><a href="startup_and_shutdown_procedure_overview.htm">Load</a> and 
		 run the <span style="font-weight: bold;">.iqf</span> using Aspen 
		 APC Manage.</p>
            </li>
            <li value="17">
                <p>View 
		 IQ properties and results in the <a href="web_based_interface_to_online_aspen_iq_applications.htm">online 
		 interface of Aspen Production Control Web Server</a> to confirm 
		 proper operation of the calculations.</p>
            </li>
        </ol>
        <table class="notebox">
            <col />
            <tbody>
                <tr>
                    <td>
                        <p><span style="font-weight: bold;">Note:</span> &#160;For 
 more information on Calculations, see the <span style="font-style: italic;">Aspen 
 Calc Help</span>.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>&#160;</p>
    </body>
</html>